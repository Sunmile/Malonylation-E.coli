%从AAindex中选出某14项理化性质指标进行编码
function AAIndex_fourteen_code= AAIndex_fourteen(seq)
%导入序列，输出矩阵
model=['A'    'R'    'N'    'D'    'C'    'Q'    'E'  ...
    'G'    'H'    'I'    'L'    'K'    'M'    'F' ...  
    'P'    'S'    'T'    'W'    'Y'    'V'  'X'];
[m,n]=size(seq);
PP=[0.87	0.85	0.09	0.66	1.52	0	0.67	0.1	0.87	3.15	2.17	1.64	1.67	2.87	2.77	0.07	0.07	3.77	2.67	1.87	0;
8.1	10.5	11.6	13	5.5	10.5	12.3	9	10.4	5.2	4.9	11.3	5.7	5.2	8	9.2	8.6	5.4	6.2	5.9	0;
0.046	0.291	0.134	0.105	0.128	0.18	0.151	0	0.23	0.186	0.186	0.219	0.221	0.29	0.131	0.062	0.108	0.409	0.298	0.14	0;
0.5	0	0	0	0	0	0	0	0.5	1.8	1.8	0	1.3	2.5	0	0	0.4	3.4	2.3	1.5	0;
93.7	250.4	146.3	142.6	135.2	177.7	182.9	52.6	188.1	182.2	173.7	215.2	197.6	228.6	0	109.5	142.1	271.6	239.9	157.2	0;
0	1	0	-1	0	0	-1	0	0	0	0	1	0	0	0	0	0	0	0	0	0;
89.09	174.2	132.12	133.1	121.15	146.15	147.13	75.07	155.16	131.17	131.17	146.19	149.21	165.19	115.13	105.09	119.12	204.24	181.19	117.15	0;
9.69	8.99	8.8	9.6	8.35	9.13	9.67	9.78	9.17	9.68	9.6	9.18	9.21	9.18	10.64	9.21	9.1	9.44	9.11	9.62	0;
2.34	1.82	2.02	1.88	1.92	2.17	2.1	2.35	1.82	2.36	2.36	2.16	2.28	2.16	1.95	2.19	2.09	2.43	2.2	2.32	0;
297	238	236	270	178	185	249	290	277	284	337	224	283	284	222	228	253	282	344	293	0;
1.8	12.5	-5.6	5.05	-16.5	6.3	12	0	-38.5	12.4	-11	14.6	-10	-34.5	-86.2	-7.5	-28	-33.7	-10	5.63	0;
154.33	341.01	207.9	194.91	219.79	235.51	223.16	127.9	242.54	233.21	232.3	300.46	202.65	204.74	179.93	174.06	205.8	237.01	229.15	207.6	0;
29.22	26.37	38.3	37.09	50.7	44.02	41.84	23.71	59.64	45	48.03	57.1	69.32	48.52	36.13	32.4	35.2	56.92	51.73	40.35	0;
30.88	68.43	41.7	40.66	53.83	46.62	44.98	24.74	65.99	49.71	50.62	63.21	55.32	51.06	39.21	35.65	36.5	60	51.15	42.75	0;]';
%选取的理化性质指标

[p,q]=size(PP);
PPscale=zeros(p,q);
for a=1:p
    M1=max(PP(a,:)) ;
    M2=min(PP(a,:));
    for b=1:q
        PPscale(a,b)=(PP(a,b)-M2)/(M1-M2);
    end
end
%对理化性质进行归一化处理

AAIndex_fourteen_code=[];
for i=1:m
    AAIndex_row=[];
    for j=1:n
        for l=1:21 
            if seq(i,j)==model(l)
                AAIndex_ele=PPscale(l,:); 
                break;
            end
        end
        AAIndex_row=[AAIndex_row, AAIndex_ele];
    end %每个序列的编码
    AAIndex_fourteen_code= [AAIndex_fourteen_code; AAIndex_row];
end
end
